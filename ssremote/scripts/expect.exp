#!/usr/bin/expect -f

set timeout 20
spawn ssh-copy-id root@localhost
expect {
    *yes/no* { send "yes\r"; exp_continue; }
    *password: { send "abc123\r"; exp_continue; }
    "*Permission *" { send_user "FAILED copy, permission denied.\n"; exit 1 }
}
expect eof
